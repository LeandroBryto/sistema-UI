<div class="layout-wrapper">
  <!-- Sidebar -->
  <div class="layout-sidebar" [class.active]="sidebarActive">
    <div class="sidebar-header">
      <h2 class="app-title">FINANCE<span class="highlight">PRO</span></h2>
    </div>
    
    <div class="sidebar-content">
      <p-panelMenu [model]="menuItems" styleClass="poseidon-menu"></p-panelMenu>
    </div>

    <div class="sidebar-footer">
      <div class="user-profile">
        <p-avatar icon="pi pi-user" styleClass="mr-2" shape="circle" [style]="{'background-color': '#3b82f6', 'color': '#ffffff'}"></p-avatar>
        <div class="user-info">
          <span class="user-name">{{ username() || 'User' }}</span>
          <span class="user-role">Admin</span>
        </div>
        <button pButton icon="pi pi-power-off" class="p-button-rounded p-button-text p-button-danger ml-auto" (click)="logout()"></button>
      </div>
    </div>
  </div>

  <!-- Mobile Mask -->
  <div class="layout-mask" *ngIf="sidebarActive" (click)="sidebarActive = false"></div>

  <!-- Main Content -->
  <div class="layout-main">
    <!-- Topbar -->
    <div class="layout-topbar">
      <div class="topbar-left">
        <i class="pi pi-bars mobile-toggle" (click)="toggleSidebar()"></i>
        <div class="search-box">
          <i class="pi pi-search"></i>
          <input type="text" pInputText placeholder="Search..." />
        </div>
      </div>
      
      <div class="topbar-right flex align-items-center gap-2">
        <!-- Theme Toggle -->
        <button pButton 
          [icon]="(isDarkTheme$ | async) ? 'pi pi-sun' : 'pi pi-moon'" 
          class="p-button-rounded p-button-text transition-colors duration-300" 
          (click)="toggleTheme()" 
          pTooltip="Alternar tema" 
          tooltipPosition="bottom">
        </button>

        <!-- User Info -->
        <div class="user-info-group flex align-items-center gap-2 hidden md:flex pr-3 mr-2">
          <p-avatar 
            [label]="username()?.charAt(0) || 'U'" 
            styleClass="bg-blue-600 text-white font-bold" 
            shape="circle">
          </p-avatar>
          <div class="flex flex-column">
            <span class="text-sm font-semibold white-space-nowrap">{{ username() || 'User' }}</span>
            <span class="text-xs opacity-70">Admin</span>
          </div>
        </div>

        <button pButton icon="pi pi-bell" class="p-button-rounded p-button-text"></button>
        <button pButton icon="pi pi-cog" class="p-button-rounded p-button-text"></button>
        <button pButton icon="pi pi-power-off" class="p-button-rounded p-button-text" (click)="logout()" pTooltip="Sair" tooltipPosition="bottom"></button>
      </div>
    </div>

    <!-- Router Outlet -->
    <div class="layout-content">
      <router-outlet></router-outlet>
    </div>
  </div>
</div>
