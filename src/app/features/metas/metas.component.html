<div class="page-container">
  <p-toast position="top-right"></p-toast>
  
  <header class="page-header">
    <div class="header-content">
      <a routerLink="/dashboard" class="back-btn">
        <i class="pi pi-arrow-left"></i>
        <span>Voltar</span>
      </a>
      <h1>Metas de Longo Prazo</h1>
    </div>
  </header>

  <div class="metas-header">
    <button pButton icon="pi pi-plus" label="Nova Meta" (click)="openMetaDialog()"></button>
  </div>
  <div class="metas-grid">
    <div class="meta-card" *ngFor="let meta of metas">
      <div class="card-header">
        <h3>{{ meta.meta }}</h3>
        <span class="badge">{{ meta.percentualConcluido | number:'1.0-0' }}%</span>
      </div>
      <div class="card-body">
        <p-progressBar [value]="meta.percentualConcluido" [showValue]="false" [style]="{'height': '10px'}"></p-progressBar>
        <div class="values">
          <span>Atual: <strong>R$ {{ meta.valorAcumulado | number:'1.2-2' }}</strong></span>
          <span>Alvo: <strong>R$ {{ meta.valorMeta | number:'1.2-2' }}</strong></span>
        </div>
        <small *ngIf="meta.descricao">{{ meta.descricao }}</small>
        <small *ngIf="meta.previsaoConclusao">Previsão: {{ meta.previsaoConclusao | date:'dd/MM/yyyy' }}</small>
      </div>
      <div class="card-footer">
        <button pButton icon="pi pi-pencil" class="p-button-rounded p-button-text p-button-warning p-button-sm" (click)="openMetaDialog(meta)"></button>
        <button pButton icon="pi pi-trash" class="p-button-rounded p-button-text p-button-danger p-button-sm" (click)="deleteMeta(meta)"></button>
      </div>
    </div>
    <div *ngIf="metas.length === 0" class="empty-state">
      Nenhuma meta definida.
    </div>
  </div>
</div>

<!-- Dialog Meta -->
<p-dialog [header]="editingMetaId ? 'Editar Meta' : 'Nova Meta'" [(visible)]="showMetaDialog" [modal]="true" [style]="{width: '400px'}">
  <div class="form-dialog">
    <div class="field">
      <label>Nome da Meta</label>
      <input pInputText [(ngModel)]="novaMeta.nomeDaMeta" placeholder="Ex: Comprar Carro" />
    </div>
    <div class="field">
      <label>Valor Alvo (R$)</label>
      <input pInputText type="number" [(ngModel)]="novaMeta.valorMeta" />
    </div>
    <div class="field">
      <label>Valor Inicial (R$)</label>
      <input pInputText type="number" [(ngModel)]="novaMeta.valorAcumulado" placeholder="Opcional" />
    </div>
    <div class="field">
      <label>Observações</label>
      <textarea pInputTextarea [(ngModel)]="novaMeta.observacao" placeholder="Observações opcionais" rows="3"></textarea>
    </div>
    <div class="field">
      <label>Previsão de Conclusão</label>
      <input pInputText type="date" [(ngModel)]="novaMeta.previsaoConclusao" />
    </div>
    <div class="actions">
      <button pButton label="Cancelar" class="p-button-text" (click)="showMetaDialog=false"></button>
      <button pButton [label]="editingMetaId ? 'Atualizar' : 'Salvar'" (click)="saveMeta()"></button>
    </div>
  </div>
</p-dialog>

<p-confirmDialog></p-confirmDialog>